<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ä¸¤åªè€è™ R&B ç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/@midi-player/core@1.0.0/lib/midi-player.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@midi-visualizer/core@1.0.0/lib/midi-visualizer.min.js"></script>
    <style>
        body {
            background: #1a1a1a;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
        }
        #visualizer {
            width: 80%;
            height: 150px;
            background: linear-gradient(45deg, #2c3e50, #3498db);
            margin: 20px;
            border-radius: 10px;
        }
        .lyrics {
            font-size: 1.2em;
            margin: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>ğŸµ ä¸¤åªè€è™ R&B ç‰ˆ</h1>
    <div id="visualizer"></div>
    <div class="lyrics" id="lyrics">
        ğŸ¶ ä¸¤åªè€è™ï¼Œä¸¤åªè€è™ï¼Œè·‘å¾—å¿«ï½ ğŸ¯
    </div>
    
    <script>
        // åˆå§‹åŒ–æ’­æ”¾å™¨
        const player = new MidiPlayer.Player(function(event) {
            // æ­Œè¯åŒæ­¥æ›´æ–°
            const lyricMap = {
                480: "ğŸ¯ ä¸¤åªè€è™ï¼Œä¸¤åªè€è™",
                960: "ğŸƒâ™‚ï¸ è·‘å¾—å¿«ï¼Œè·‘å¾—å¿«ï½",
                1440: "ğŸ‘‚ ä¸€åªæ²¡æœ‰è€³æœµ",
                1920: "ğŸ‘€ ä¸€åªæ²¡æœ‰å°¾å·´",
                2400: "ğŸ¤” çœŸå¥‡æ€ªï¼çœŸå¥‡æ€ªï¼"
            };
            if (lyricMap[event.tick]) {
                document.getElementById('lyrics').innerHTML = lyricMap[event.tick];
            }
        });

        // åŠ è½½MIDIæ–‡ä»¶
        fetch('two_tigers_rb.mid')
            .then(response => response.arrayBuffer())
            .then(midiData => {
                player.loadArrayBuffer(midiData);
                player.play();
                
                // åˆå§‹åŒ–å¯è§†åŒ–
                const visualizer = new MidiVisualizer("#visualizer");
                visualizer.connect(player);
            });

        // è‡ªåŠ¨æ’­æ”¾å¤„ç†
        document.addEventListener('click', function() {
            AudioContext = AudioContext || webkitAudioContext;
            const context = new AudioContext();
            context.resume().then(() => {
                console.log('Playback started');
            });
        }, { once: true });
    </script>
</body>
</html>
